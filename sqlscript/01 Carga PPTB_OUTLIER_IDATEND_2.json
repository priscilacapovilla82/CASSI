{
	"name": "01 Carga PPTB_OUTLIER_IDATEND_2",
	"properties": {
		"content": {
			"query": "drop table PRODML.PPTB_OUTLIER_IDATEND_2\ngo \n\nIF NOT EXISTS (SELECT * FROM sys.objects O JOIN sys.schemas S ON O.schema_id = S.schema_id WHERE O.NAME = 'PPTB_OUTLIER_IDATEND_2' AND O.TYPE = 'U' AND S.NAME = 'PROD')\nCREATE TABLE PRODML.PPTB_OUTLIER_IDATEND_2\n\t(\n\t [ANOMESATEND] nvarchar(4000),\n\t [ID_ATEND_BENEF] nvarchar(4000),\n\t [ID_ATEND_PRESTADOR] nvarchar(4000),\n\t [DATAPAGAMENTO] datetime2(7),\n\t [CARTAREMESSA] int,\n\t [TABREGIMEPGTO] int,\n\t [PEG] int,\n\t [SITUACAO] nvarchar(4000),\n\t [CD_PRESTADOR] nvarchar(4000),\n\t [NO_PRESTADOR] nvarchar(4000),\n\t [FISICAJURIDICA] int,\n\t [CD_TIPO_PRESTADOR] int,\n\t [DS_TIPO_PRESTADOR] nvarchar(4000),\n\t [EVENTOIMPORTADO] nvarchar(4000),\n\t [DESCRICAOIMPORTADA] nvarchar(4000),\n\t [DT_ATENDIMENTO] datetime2(7),\n\t [HD_BENEFICIARIO] int,\n\t [MT_BENEF] int,\n\t [SEXO] nvarchar(4000),\n\t [IDADE] int,\n\t [HD_CLASSE_EVENTO] int,\n\t [DS_CLASSE_EVENTO] nvarchar(4000),\n\t [HD_TGE_EVENTO] int,\n\t [ESTRUTURA_EVENTO] nvarchar(4000),\n\t [DS_EVENTO] nvarchar(4000),\n\t [GRAU] int,\n\t [DS_GRAU] nvarchar(4000),\n\t [EVENTO_AUTORIZ] int,\n\t [CBOS_EXECUTANTE] nvarchar(4000),\n\t [CBOS_SOLICITANTE] nvarchar(4000),\n\t [CONSELHOPROFEXECUTANTE] nvarchar(4000),\n\t [CONSELHOPROFEXECUTANTETISS] int,\n\t [CONSELHOPROFSOLICITANTETISS] int,\n\t [NUMEROPROFEXECUTANTE] nvarchar(4000),\n\t [CODIGODESPESA] int,\n\t [VIADEACESSOTISS] numeric(38,18),\n\t [TARGET] nvarchar(4000),\n\t [HDGUIA_GROUP] nvarchar(4000),\n\t [GUIA_GROUP] nvarchar(4000),\n\t [AUTORIZACAO_GROUP] nvarchar(4000),\n\t [CD_TIPO_ATENDIMENTO_GROUP] nvarchar(4000),\n\t [TIPO_ATENDIMENTO_GROUP] nvarchar(4000),\n\t [HD_EVENTO_GROUP] nvarchar(4000),\n\t [REGRA_AUT_GUIA_GROUP] nvarchar(4000),\n\t [MODELO_GUIA_GROUP] nvarchar(4000),\n\t [QTDPAGTO] float,\n\t [QTDGLOSADA] float,\n\t [QTDAPRESENTADA] float,\n\t [VALORAPRESENTADO] float,\n\t [VALORCALCPAGTO] float,\n\t [VALORPAGOORIGINAL] float,\n\t [VALORPAGTO] float,\n\t [VALORGLOSADOORIGINAL] float,\n\t [VALORGLOSADO] float,\n\t [QTDAUTORIZADA] float,\n\t [QTDPAGA] float,\n\t [HD_TGE_EVENTO2] int,\n\t [GRAU2] int,\n\t [QTDPAGTO_mean] float,\n\t [QTDPAGTO_std] float,\n\t [LMSP] float,\n\t [LMSP_EX] float,\n\t [LMSP_99] float,\n\t [LMSP_995] float,\n\t [OUTLIER] int,\n\t [OUTLIER_EX] int,\n\t [OUTLIER_995] int,\n\t [OUTLIER_99] int,\n\t [VLR_CORRETO] float,\n\t [VLR_SAVE] float,\n\t [VLR_CORRETO_EX] float,\n\t [VLR_SAVE_EX] float,\n\t [VLR_CORRETO_99] float,\n\t [VLR_SAVE_99] float,\n\t [VLR_CORRETO_995] float,\n\t [VLR_SAVE_995] float,\n\t [PRESTADOR] nvarchar(4000),\n\t [EVENTO] nvarchar(4000),\n\t [CVIADEACESSOTISS] int\n\t)\nWITH\n\t(\n\tDISTRIBUTION = ROUND_ROBIN,\n\t CLUSTERED COLUMNSTORE INDEX\n\t -- HEAP\n\t)\nGO\n\n--Uncomment the 4 lines below to create a stored procedure for data pipeline orchestrationâ€‹\n--CREATE PROC bulk_load_PPTB_OUTLIER_IDATEND_2\n--AS\n--BEGIN\nCOPY INTO PRODML.PPTB_OUTLIER_IDATEND_2\n(ANOMESATEND 1, ID_ATEND_BENEF 2, ID_ATEND_PRESTADOR 3, DATAPAGAMENTO 4, CARTAREMESSA 5, TABREGIMEPGTO 6, PEG 7, SITUACAO 8, CD_PRESTADOR 9, NO_PRESTADOR 10, FISICAJURIDICA 11, CD_TIPO_PRESTADOR 12, DS_TIPO_PRESTADOR 13, EVENTOIMPORTADO 14, DESCRICAOIMPORTADA 15, DT_ATENDIMENTO 16, HD_BENEFICIARIO 17, MT_BENEF 18, SEXO 19, IDADE 20, HD_CLASSE_EVENTO 21, DS_CLASSE_EVENTO 22, HD_TGE_EVENTO 23, ESTRUTURA_EVENTO 24, DS_EVENTO 25, GRAU 26, DS_GRAU 27, EVENTO_AUTORIZ 28, CBOS_EXECUTANTE 29, CBOS_SOLICITANTE 30, CONSELHOPROFEXECUTANTE 31, CONSELHOPROFEXECUTANTETISS 32, CONSELHOPROFSOLICITANTETISS 33, NUMEROPROFEXECUTANTE 34, CODIGODESPESA 35, VIADEACESSOTISS 36, TARGET 37, HDGUIA_GROUP 38, GUIA_GROUP 39, AUTORIZACAO_GROUP 40, CD_TIPO_ATENDIMENTO_GROUP 41, TIPO_ATENDIMENTO_GROUP 42, HD_EVENTO_GROUP 43, REGRA_AUT_GUIA_GROUP 44, MODELO_GUIA_GROUP 45, QTDPAGTO 46, QTDGLOSADA 47, QTDAPRESENTADA 48, VALORAPRESENTADO 49, VALORCALCPAGTO 50, VALORPAGOORIGINAL 51, VALORPAGTO 52, VALORGLOSADOORIGINAL 53, VALORGLOSADO 54, QTDAUTORIZADA 55, QTDPAGA 56, HD_TGE_EVENTO2 57, GRAU2 58, QTDPAGTO_mean 59, QTDPAGTO_std 60, LMSP 61, LMSP_EX 62, LMSP_99 63, LMSP_995 64, OUTLIER 65, OUTLIER_EX 66, OUTLIER_995 67, OUTLIER_99 68, VLR_CORRETO 69, VLR_SAVE 70, VLR_CORRETO_EX 71, VLR_SAVE_EX 72, VLR_CORRETO_99 73, VLR_SAVE_99 74, VLR_CORRETO_995 75, VLR_SAVE_995 76, PRESTADOR 77, EVENTO 78, CVIADEACESSOTISS 79)\nFROM 'https://stgcassigsmadatalake02.dfs.core.windows.net/data/raw-data/PPTB_OUTLIER_IDATEND_2'\nWITH\n(\n\tFILE_TYPE = 'PARQUET'\n\t,MAXERRORS = 0\n)\n--END\nGO\n\nSELECT TOP 100 * FROM PRODML.PPTB_OUTLIER_IDATEND_2\nGO",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "synsqlprod",
				"poolName": "synsqlprod"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}