{
	"name": "QRY2_VL_PRESTADORES",
	"properties": {
		"folder": {
			"name": "FATOS/DIARIAS/AUTORIZACAO"
		},
		"content": {
			"query": "SELECT DISTINCT \n     PR.HANDLE AS HD_PRESTADOR\n    ,TGE.HANDLE AS HD_TGE\n    ,CBO.HANDLE AS HD_CBO\n    ,DT.TIPOATENDIMENTO AS HD_REGIME_ATENDIMENTO\n    ,GRA.HANDLE AS HD_GRAU\n    ,DT.DATAINICIAL AS DT_INICIAL\n    ,DT.DATAFINAL AS DT_FINAL\n    ,DT.PORTEANESTESICO AS NU_PORTE_ANESTESICO\n    ,DT.PORTESALA AS NU_PORTE_SALA\n\n    ,(DT.QTDUSHONORARIO*DT.PERCENTUALPGTOUS*VUS.VALORUSHONORARIO)/100     AS VL_US\n    ,(DT.QTDUSCUSTOOPERACIONAL*DT.PERCENTUALPGTOCUSTO*VCO.VALORUSCUSTOOPERACIONAL)/100  AS VL_UCO --Unidade Custo Operacional\n    ,(DT.FATORFILME*DT.PERCENTUALPGTOFILME* VIL.FILMEVALOR)/100    AS VL_FILME\n\nFROM PROSTG.SAM_PRESTADOR                                       PR\n          JOIN PROSTG.SAM_PRECOPRESTADOR_DOTAC                  DT     ON PR.HANDLE  = DT.PRESTADOR\n          JOIN PROSTG.SAM_TGE                                   TGE    ON TGE.HANDLE = DT.EVENTO\n     LEFT JOIN PROSTG.SAM_GRAU                                  GRA    ON TGE.HANDLE = GRA.TERMO\n     LEFT JOIN PROSTG.TIS_CBOS                                  CBO    ON CBO.HANDLE = DT.CBOSTISS       \n     LEFT JOIN PROSTG.TIS_TABELAPRECO                           TD     ON TD.HANDLE = TGE.TABELADOMINIOTISS\n     LEFT JOIN PROSTG.SAM_TABCUSTOOPERAC                        UCO    ON UCO.HANDLE = DT.TABELACUSTOOPERAC \n     LEFT JOIN PROSTG.SAM_TABCUSTOOPERAC_VLR                    VCO    ON UCO.HANDLE = VCO.TABELACUSTOOPERACUS\n     LEFT JOIN PROSTG.SAM_TABUS                                 US     ON US.HANDLE  = DT.TABELAUS\n     LEFT JOIN PROSTG.SAM_TABUS_VLR                             VUS    ON US.HANDLE  = VUS.TABELAUS\n     LEFT JOIN PROSTG.SAM_TABFILME                              FIL    ON DT.TABELAFILME = FIL.HANDLE\n     LEFT JOIN PROSTG.SAM_TABFILME_VLR                          VIL    ON FIL.HANDLE = VIL.TABELAFILME\n\n WHERE TD.CODIGO = 22\n      AND VIL.DATAFINAL IS NULL\n      AND VUS.DATAFINAL IS NULL\n      AND VCO.DATAFINAL IS NULL\n\nAND '2022-01-01' BETWEEN SUBSTRING(CAST(DT.DATAINICIAL AS VARCHAR),1,10) AND SUBSTRING(CAST(ISNULL(DT.DATAFINAL,'9999-12-31') AS VARCHAR),1,10)",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "synsqlprod",
				"poolName": "synsqlprod"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}