{
	"name": "SQL script 10",
	"properties": {
		"content": {
			"query": "IF NOT EXISTS (SELECT * FROM sys.objects O JOIN sys.schemas S ON O.schema_id = S.schema_id WHERE O.NAME = 'PPTB_OUTLIER_IDATEND_2' AND O.TYPE = 'U' AND S.NAME = 'PRODML')\nCREATE TABLE PRODML.PPTB_OUTLIER_IDATEND_2\n\t(\n\t [HDGUIA_GROUP] nvarchar(4000),\n\t [ANOMESATEND] nvarchar(4000),\n\t [ID_ATEND_BENEF] nvarchar(4000),\n\t [ID_ATEND_PRESTADOR] nvarchar(4000),\n\t [DATAPAGAMENTO] datetime2(7),\n\t [CARTAREMESSA] float,\n\t [TABREGIMEPGTO] numeric(38,18),\n\t [PEG] float,\n\t [SITUACAO] nvarchar(4000),\n\t [CD_PRESTADOR] nvarchar(4000),\n\t [NO_PRESTADOR] nvarchar(4000),\n\t [FISICAJURIDICA] numeric(38,18),\n\t [CD_TIPO_PRESTADOR] numeric(38,18),\n\t [DS_TIPO_PRESTADOR] nvarchar(4000),\n\t [EVENTOIMPORTADO] nvarchar(4000),\n\t [DESCRICAOIMPORTADA] nvarchar(4000),\n\t [DT_ATENDIMENTO] datetime2(7),\n\t [HD_BENEFICIARIO] numeric(38,18),\n\t [MT_BENEF] numeric(38,18),\n\t [SEXO] nvarchar(4000),\n\t [IDADE] bigint,\n\t [HD_CLASSE_EVENTO] numeric(38,18),\n\t [DS_CLASSE_EVENTO] nvarchar(4000),\n\t [HD_TGE_EVENTO] int,\n\t [ESTRUTURA_EVENTO] nvarchar(4000),\n\t [DS_EVENTO] nvarchar(4000),\n\t [GRAU] numeric(38,18),\n\t [DS_GRAU] nvarchar(4000),\n\t [EVENTO_AUTORIZ] int,\n\t [CBOS_EXECUTANTE] nvarchar(4000),\n\t [CBOS_SOLICITANTE] nvarchar(4000),\n\t [CONSELHOPROFEXECUTANTE] nvarchar(4000),\n\t [CONSELHOPROFEXECUTANTETISS] numeric(38,18),\n\t [CONSELHOPROFSOLICITANTETISS] numeric(38,18),\n\t [NUMEROPROFEXECUTANTE] nvarchar(4000),\n\t [CODIGODESPESA] numeric(38,18),\n\t [VIADEACESSOTISS] numeric(38,18),\n\t [TARGET] nvarchar(4000),\n\t [GUIA_GROUP] nvarchar(4000),\n\t [AUTORIZACAO_GROUP] nvarchar(4000),\n\t [CD_TIPO_ATENDIMENTO_GROUP] nvarchar(4000),\n\t [TIPO_ATENDIMENTO_GROUP] nvarchar(4000),\n\t [HD_EVENTO_GROUP] nvarchar(4000),\n\t [REGRA_AUT_GUIA_GROUP] nvarchar(4000),\n\t [MODELO_GUIA_GROUP] nvarchar(4000),\n\t [QTDPAGTO] float,\n\t [QTDGLOSADA] float,\n\t [QTDAPRESENTADA] float,\n\t [VALORAPRESENTADO] float,\n\t [VALORCALCPAGTO] float,\n\t [VALORPAGOORIGINAL] float,\n\t [VALORPAGTO] float,\n\t [VALORGLOSADOORIGINAL] float,\n\t [VALORGLOSADO] float,\n\t [QTDAUTORIZADA] float,\n\t [QTDPAGA] float,\n\t [HD_TGE_EVENTO2] int,\n\t [GRAU2] numeric(38,18),\n\t [QTDPAGTO_mean] float,\n\t [QTDPAGTO_std] float,\n\t [LMSP] float,\n\t [LMSP_EX] float,\n\t [LMSP_99] float,\n\t [LMSP_995] float,\n\t [OUTLIER] int,\n\t [OUTLIER_EX] int,\n\t [OUTLIER_995] int,\n\t [OUTLIER_99] int,\n\t [VLR_CORRETO] float,\n\t [VLR_SAVE] float,\n\t [VLR_CORRETO_EX] float,\n\t [VLR_SAVE_EX] float,\n\t [VLR_CORRETO_99] float,\n\t [VLR_SAVE_99] float,\n\t [VLR_CORRETO_995] float,\n\t [VLR_SAVE_995] float,\n\t [PRESTADOR] nvarchar(4000),\n\t [EVENTO] nvarchar(4000),\n\t [QTD_GUIAS] int,\n\t [FINALIDADE_GROUP] nvarchar(4000)\n\t)\nWITH\n\t(\n\tDISTRIBUTION = ROUND_ROBIN,\n\t CLUSTERED COLUMNSTORE INDEX\n\t -- HEAP\n\t)\nGO\n\n--Uncomment the 4 lines below to create a stored procedure for data pipeline orchestrationâ€‹\n--CREATE PROC bulk_load_PPTB_OUTLIER_IDATEND_2\n--AS\n--BEGIN\nCOPY INTO PRODML.PPTB_OUTLIER_IDATEND_2\n(HDGUIA_GROUP 1, ANOMESATEND 2, ID_ATEND_BENEF 3, ID_ATEND_PRESTADOR 4, DATAPAGAMENTO 5, CARTAREMESSA 6, TABREGIMEPGTO 7, PEG 8, SITUACAO 9, CD_PRESTADOR 10, NO_PRESTADOR 11, FISICAJURIDICA 12, CD_TIPO_PRESTADOR 13, DS_TIPO_PRESTADOR 14, EVENTOIMPORTADO 15, DESCRICAOIMPORTADA 16, DT_ATENDIMENTO 17, HD_BENEFICIARIO 18, MT_BENEF 19, SEXO 20, IDADE 21, HD_CLASSE_EVENTO 22, DS_CLASSE_EVENTO 23, HD_TGE_EVENTO 24, ESTRUTURA_EVENTO 25, DS_EVENTO 26, GRAU 27, DS_GRAU 28, EVENTO_AUTORIZ 29, CBOS_EXECUTANTE 30, CBOS_SOLICITANTE 31, CONSELHOPROFEXECUTANTE 32, CONSELHOPROFEXECUTANTETISS 33, CONSELHOPROFSOLICITANTETISS 34, NUMEROPROFEXECUTANTE 35, CODIGODESPESA 36, VIADEACESSOTISS 37, TARGET 38, GUIA_GROUP 39, AUTORIZACAO_GROUP 40, CD_TIPO_ATENDIMENTO_GROUP 41, TIPO_ATENDIMENTO_GROUP 42, HD_EVENTO_GROUP 43, REGRA_AUT_GUIA_GROUP 44, MODELO_GUIA_GROUP 45, QTDPAGTO 46, QTDGLOSADA 47, QTDAPRESENTADA 48, VALORAPRESENTADO 49, VALORCALCPAGTO 50, VALORPAGOORIGINAL 51, VALORPAGTO 52, VALORGLOSADOORIGINAL 53, VALORGLOSADO 54, QTDAUTORIZADA 55, QTDPAGA 56, HD_TGE_EVENTO2 57, GRAU2 58, QTDPAGTO_mean 59, QTDPAGTO_std 60, LMSP 61, LMSP_EX 62, LMSP_99 63, LMSP_995 64, OUTLIER 65, OUTLIER_EX 66, OUTLIER_995 67, OUTLIER_99 68, VLR_CORRETO 69, VLR_SAVE 70, VLR_CORRETO_EX 71, VLR_SAVE_EX 72, VLR_CORRETO_99 73, VLR_SAVE_99 74, VLR_CORRETO_995 75, VLR_SAVE_995 76, PRESTADOR 77, EVENTO 78, QTD_GUIAS 79, FINALIDADE_GROUP 80)\nFROM 'https://stgcassigsmadatalake02.dfs.core.windows.net/data/raw-data/PPTB_OUTLIER_IDATEND_2'\nWITH\n(\n\tFILE_TYPE = 'PARQUET'\n\t,MAXERRORS = 0\n)\n--END\nGO\n\nSELECT TOP 100 * FROM PRODML.PPTB_OUTLIER_IDATEND_2\nGO",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "synsqlprod",
				"poolName": "synsqlprod"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}